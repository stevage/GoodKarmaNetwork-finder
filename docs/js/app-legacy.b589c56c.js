(function(){"use strict";var e={4815:function(e,t,n){n(3792),n(3362),n(9085),n(9391);var i=n(3751),o=n(641),r=n(33),a={class:"flex flex-column vh-100 sans-serif",id:"app"},s={class:"flex flex-auto",id:"middle"},c={class:"container br bg-white b--light-gray overflow-auto pa2 bw2"},u={class:"relative flex-auto",id:"map-container"},d={key:0},l={key:1};function p(e,t,n,p,f,m){var h=(0,o.g2)("FeatureInfo"),v=(0,o.g2)("Sites"),b=(0,o.g2)("Map");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",s,[(0,o.Lk)("div",{id:"sidebar",class:(0,r.C4)({collapsed:!e.sidebarOpen})},[(0,o.Lk)("div",c,[(0,o.bF)(h,{class:"mb5"}),t[2]||(t[2]=(0,o.Lk)("p",null,"Enter your suburb to find your nearest group",-1)),t[3]||(t[3]=(0,o.Lk)("div",{id:"geocoder"},null,-1)),(0,o.bF)(v)])],2),(0,o.bo)((0,o.Lk)("div",{class:"relative br b--gray bw2",id:"sidebar-rim",style:{width:"20px"},onClick:t[0]||(t[0]=function(t){return e.sidebarOpen=!0})},null,512),[[i.aG,!e.sidebarOpen]]),(0,o.Lk)("div",u,[(0,o.bF)(b),(0,o.Lk)("div",{class:"absolute bg-white f3 br bt bb br--right br-100 b--magenta bw1 magenta pa1 pointer grow fw8",id:"sidebarToggle",onClick:t[1]||(t[1]=function(){return m.toggleSidebar&&m.toggleSidebar.apply(m,arguments)})},[e.sidebarOpen?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",d,"→")),e.sidebarOpen?((0,o.uX)(),(0,o.CE)("span",l,"←")):(0,o.Q3)("",!0)]),t[4]||(t[4]=(0,o.Lk)("div",{class:"absolute",id:"overlay"},null,-1))])])])}n(2062),n(8111),n(1701),n(6099);var f={class:"absolute absolute--fill",id:"map"};function m(e,t,n,i,r,a){return(0,o.uX)(),(0,o.CE)("div",f)}var h=n(6923),v=n(4649),b=n(1962),g=n(7114),w=n(8538),k=n(842),y=n.n(k),C=n(5915),O=n.n(C),I=n(1395);function A(e){return{type:"FeatureCollection",features:e.map(function(e,t){return{type:"Feature",geometry:{type:"Point",coordinates:[+e.Lng,+e.Lat]},properties:(0,w.A)({id:t},e)}})}}var S={data:function(){return{selectedId:void 0}},mounted:function(){var e=this;return(0,g.A)((0,b.A)().m(function t(){var n,i,o;return(0,b.A)().w(function(t){while(1)switch(t.n){case 0:y().accessToken="pk.eyJ1Ijoic3RldmFnZSIsImEiOiJjbWpyeWVwOGI0ajU2M2hwczVrdTExYmRqIn0.0EucCvUlczA1q4JGJvV2NA",n=new(y().Map)({container:"map",center:[145,-37.8],zoom:12,style:"mapbox://styles/mapbox/light-v9"}),n.addControl(new(y().NavigationControl),"top-left"),i=new(O())({mapboxgl:y(),accessToken:y().accessToken,countries:"au",types:"region,postcode,district,place,locality,neighborhood,address"}),document.getElementById("geocoder").appendChild(i.onAdd(n)),i.on("result",function(e){var t=e.result;console.log(t),window.Sites.home=t.geometry.coordinates}).on("clear",function(){window.Sites.home=null}),I.A.init(n,y()),o=window.location.origin+"/",n.U.loadImage("marker","".concat(o,"marker-outline2.png")),n.U.loadImage("marker-highlight","".concat(o,"marker-magenta.png")),window.map=n,n.U.onLoad(function(){return e.initMap(n)}),n.on("mousedown",function(){document.getElementById("map").clientWidth<150&&(window.App.sidebarOpen=!1)});case 1:return t.a(2)}},t)}))()},methods:{highlight:function(e){map.flyTo({center:e.geometry.coordinates,zoom:13}),window.FeatureInfo.feature=e,map.U.setIconImage("sites-pins",["case",["==",["get","id"],e.properties.id],"marker-highlight","marker"]),map.U.setIconSize("sites-pins",["case",["==",["get","id"],e.properties.id],.75,.5])},zoomToBounds:function(e){map.fitBounds(e)},initMap:function(e){var t=this;return(0,g.A)((0,b.A)().m(function i(){var o,r,a,s;return(0,b.A)().w(function(i){while(1)switch(i.n){case 0:return o=n(5401),r="https://docs.google.com/spreadsheets/d/e/2PACX-1vSEXu2wQN2zDyNMc8YTu7YhjERf24r1A9a2CS2uuaEwgAWfkMT99pNaDrh0QuYcgi_aGdtJU0YNRaBF/pub?output=csv",s=A,i.n=1,o.csv(r);case 1:a=s(i.v),e.U.addGeoJSON("sites",a),console.log(a),e.U.addCircle("sites-circles","sites",{circleColor:"black",circleRadius:{stops:[[10,3],[12,5]]}}),e.U.addSymbol("sites-pins","sites",{iconImage:"marker",iconSize:{stops:[[9,.25],[11,.5]]},iconOffset:[0,-30],textField:{stops:[[12.5,""],[13,"{Name}"]]},textOffset:[0,1],textOptional:!0,textSize:14,textColor:"hsl(331, 50%, 50%)"}),e.U.hoverPopup(["sites-circles","sites-pins"],function(e){return e.properties.Name}),e.U.hoverPointer("sites-pins"),e.on("click","sites-pins",function(e){var n=(0,v.A)(e.features,1),i=n[0];window.FeatureInfo.feature=i,t.highlight(i),window.App.sidebarOpen=!0,document.getElementById("FeatureInfo").scrollIntoView()}),window.Sites.sites=(0,h.A)(a.features);case 2:return i.a(2)}},i)}))()}}},x=n(6262);const E=(0,x.A)(S,[["render",m]]);var L=E,F={key:0,class:"ph2 pb3",id:"FeatureInfo"},M={class:"text--gray"},N={key:0,class:"info p tc mt4 grow"},_=["href"];function T(e,t,n,i,a,s){return e.feature?((0,o.uX)(),(0,o.CE)("div",F,[(0,o.Lk)("h3",null,(0,r.v_)(s.p.Name),1),(0,o.Lk)("p",M,(0,r.v_)(s.p["More Information"]),1),s.p.URL?((0,o.uX)(),(0,o.CE)("div",N,[(0,o.Lk)("a",{class:"br-pill pa2 ph3 no-underline",href:s.p.URL,target:"_blank"},"Learn more",8,_)])):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:"view-on-map dn-ns tc mt4 pointer grow",onClick:t[0]||(t[0]=function(){return s.viewOnMap&&s.viewOnMap.apply(s,arguments)})},(0,h.A)(t[1]||(t[1]=[(0,o.Lk)("span",{class:"br-pill pa2"},"View on map",-1)])))])):(0,o.Q3)("",!0)}var U={name:"FeatureInfo",data:function(){return{feature:void 0}},computed:{p:function(){return this.feature.properties}},created:function(){window.FeatureInfo=this},methods:{viewOnMap:function(){window.App.sidebarOpen=!1}}};const X=(0,x.A)(U,[["render",T],["__scopeId","data-v-377ca9d5"]]);var j=X,z=(n(7495),n(5440),{key:0,class:"mt2",id:"Sites"}),P={key:0,class:"nearest"},B=["onClick"],G={class:"name dib w-70 pa1"},Q={class:"distance dib w-30 ph1 pv1"},R={key:1,class:"all"},J=["onClick"],V={class:"name dib w-70 pa1"};function Y(e,t,n,i,a,s){return e.sites?((0,o.uX)(),(0,o.CE)("div",z,[e.home?((0,o.uX)(),(0,o.CE)("div",P,[t[0]||(t[0]=(0,o.Lk)("h3",null,"Nearest groups",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.nearestSites,function(e){return(0,o.uX)(),(0,o.CE)("div",{class:(0,r.C4)(["site pointer glow o-70",{selected:s.selected(e)}]),onClick:function(t){return s.click(e)}},[(0,o.Lk)("div",G,(0,r.v_)(e.properties["Name"].replace(/ Good Karma Network/i,"")),1),(0,o.Lk)("div",Q,(0,r.v_)(Math.round(e.distance))+" km",1)],10,B)}),256))])):((0,o.uX)(),(0,o.CE)("div",R,[t[1]||(t[1]=(0,o.Lk)("h3",null,"All groups",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.alphabetisedSites,function(e){return(0,o.uX)(),(0,o.CE)("div",{class:(0,r.C4)(["site pointer glow o-70",{selected:s.selected(e)}]),onClick:function(t){return s.click(e)}},[(0,o.Lk)("div",V,(0,r.v_)(e.properties["Name"].replace(/ Good Karma Network/i,"")),1)],10,J)}),256))]))])):(0,o.Q3)("",!0)}var K=n(8670),W=(n(8706),n(4782),n(6910),n(6033),n(7764),n(2953),n(4406)),q=n(2154),D=n.n(q),Z={name:"Sites",data:function(){return{sites:void 0,home:void 0}},created:function(){window.Sites=this},watch:{home:function(){var e,t=(0,W.A)(this.home[1]),n=(0,K.A)(this.sites);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.distance=t.distance(this.home,i.geometry.coordinates)}}catch(o){n.e(o)}finally{n.f()}this.sites.sort(function(e,t){return e.distance-t.distance}),window.Map.zoomToBounds(this.bbox)}},methods:{click:function(e){window.Map.highlight(e)},selected:function(e){return window.FeatureInfo.feature&&window.FeatureInfo.feature.properties.id===e.properties.id}},computed:{alphabetisedSites:function(){return this.sites.slice().sort(function(e,t){return e.properties.Name>t.properties.Name?1:-1})},nearestSites:function(){return this.sites.slice(0,5)},bbox:function(){var e={type:"Feature",properties:{},geometry:{type:"Point",coordinates:this.home}};return D().extent({type:"FeatureCollection",features:[e].concat((0,h.A)(this.nearestSites))})}}};const $=(0,x.A)(Z,[["render",Y],["__scopeId","data-v-a68b4e58"]]);var H=$;console.log(H);var ee={name:"app",created:function(){window.App=this},data:function(){return{sidebarOpen:!0}},components:{Map:L,FeatureInfo:j,Sites:H},watch:{sidebarOpen:function(){this.$nextTick(function(){return window.map.resize()})}},methods:{toggleSidebar:function(){this.sidebarOpen=!this.sidebarOpen}}};n(6077);const te=(0,x.A)(ee,[["render",p]]);var ne=te;(0,i.Ef)(ne).mount("#app")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,function(){var e=[];n.O=function(t,i,o,r){if(!i){var a=1/0;for(d=0;d<e.length;d++){i=e[d][0],o=e[d][1],r=e[d][2];for(var s=!0,c=0;c<i.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every(function(e){return n.O[e](i[c])})?i.splice(c--,1):(s=!1,r<a&&(a=r));if(s){e.splice(d--,1);var u=o();void 0!==u&&(t=u)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[i,o,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var o,r,a=i[0],s=i[1],c=i[2],u=0;if(a.some(function(t){return 0!==e[t]})){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(c)var d=c(n)}for(t&&t(i);u<a.length;u++)r=a[u],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},i=self["webpackChunkmap_template"]=self["webpackChunkmap_template"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[504],function(){return n(4815)});i=n.O(i)})();
//# sourceMappingURL=app-legacy.b589c56c.js.map