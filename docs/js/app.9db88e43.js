(function(){"use strict";var e={1546:function(e,t,o){var i=o(3751),n=o(641),r=o(33);const s={class:"flex flex-column vh-100 sans-serif",id:"app"},a={class:"flex flex-auto",id:"middle"},d={class:"container br bg-white b--light-gray overflow-auto pa2 bw2"},c={class:"relative flex-auto",id:"map-container"},l={key:0},p={key:1};function u(e,t,o,u,m,f){const h=(0,n.g2)("FeatureInfo"),b=(0,n.g2)("Sites"),g=(0,n.g2)("Map");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",a,[(0,n.Lk)("div",{id:"sidebar",class:(0,r.C4)({collapsed:!e.sidebarOpen})},[(0,n.Lk)("div",d,[(0,n.bF)(h,{class:"mb5"}),t[2]||(t[2]=(0,n.Lk)("p",null,"Enter your suburb to find your nearest group",-1)),t[3]||(t[3]=(0,n.Lk)("div",{id:"geocoder"},null,-1)),(0,n.bF)(b)])],2),(0,n.bo)((0,n.Lk)("div",{class:"relative br b--gray bw2",id:"sidebar-rim",style:{width:"20px"},onClick:t[0]||(t[0]=t=>e.sidebarOpen=!0)},null,512),[[i.aG,!e.sidebarOpen]]),(0,n.Lk)("div",c,[(0,n.bF)(g),(0,n.Lk)("div",{class:"absolute bg-white f3 br bt bb br--right br-100 b--magenta bw1 magenta pa1 pointer grow fw8",id:"sidebarToggle",onClick:t[1]||(t[1]=(...e)=>f.toggleSidebar&&f.toggleSidebar(...e))},[e.sidebarOpen?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("span",l,"→")),e.sidebarOpen?((0,n.uX)(),(0,n.CE)("span",p,"←")):(0,n.Q3)("",!0)]),t[4]||(t[4]=(0,n.Lk)("div",{class:"absolute",id:"overlay"},null,-1))])])])}o(8111),o(1701);const m={class:"absolute absolute--fill",id:"map"};function f(e,t,o,i,r,s){return(0,n.uX)(),(0,n.CE)("div",m)}var h=o(842),b=o.n(h),g=o(5915),v=o.n(g),w=o(1395);function k(e){return{type:"FeatureCollection",features:e.map((e,t)=>({type:"Feature",geometry:{type:"Point",coordinates:[+e.Lng,+e.Lat]},properties:{id:t,...e}}))}}var y={data:()=>({selectedId:void 0}),async mounted(){b().accessToken="pk.eyJ1Ijoic3RldmFnZSIsImEiOiJjbWpyeWVwOGI0ajU2M2hwczVrdTExYmRqIn0.0EucCvUlczA1q4JGJvV2NA";const e=new(b().Map)({container:"map",center:[145,-37.8],zoom:12,style:"mapbox://styles/mapbox/light-v9"});e.addControl(new(b().NavigationControl),"top-left");const t=new(v())({mapboxgl:b(),accessToken:b().accessToken,countries:"au",types:"region,postcode,district,place,locality,neighborhood,address"});document.getElementById("geocoder").appendChild(t.onAdd(e)),t.on("result",({result:e})=>{console.log(e),window.Sites.home=e.geometry.coordinates}).on("clear",()=>{window.Sites.home=null}),w.A.init(e,b());const o=window.location.origin+"/";e.U.loadImage("marker",`${o}marker-outline2.png`),e.U.loadImage("marker-highlight",`${o}marker-magenta.png`),window.map=e,e.U.onLoad(()=>this.initMap(e)),e.on("mousedown",()=>{document.getElementById("map").clientWidth<150&&(window.App.sidebarOpen=!1)})},methods:{highlight(e){map.flyTo({center:e.geometry.coordinates,zoom:13}),window.FeatureInfo.feature=e,map.U.setIconImage("sites-pins",["case",["==",["get","id"],e.properties.id],"marker-highlight","marker"]),map.U.setIconSize("sites-pins",["case",["==",["get","id"],e.properties.id],.75,.5])},zoomToBounds(e){map.fitBounds(e)},async initMap(e){const t=o(5401),i="https://docs.google.com/spreadsheets/d/e/2PACX-1vSEXu2wQN2zDyNMc8YTu7YhjERf24r1A9a2CS2uuaEwgAWfkMT99pNaDrh0QuYcgi_aGdtJU0YNRaBF/pub?output=csv",n=k(await t.csv(i));e.U.addGeoJSON("sites",n),console.log(n),e.U.addCircle("sites-circles","sites",{circleColor:"black",circleRadius:{stops:[[10,3],[12,5]]}}),e.U.addSymbol("sites-pins","sites",{iconImage:"marker",iconSize:{stops:[[9,.25],[11,.5]]},iconOffset:[0,-30],textField:{stops:[[12.5,""],[13,"{Name}"]]},textOffset:[0,1],textOptional:!0,textSize:14,textColor:"hsl(331, 50%, 50%)"}),e.U.hoverPopup(["sites-circles","sites-pins"],e=>e.properties.Name),e.U.hoverPointer("sites-pins"),e.on("click","sites-pins",({features:[e]})=>{window.FeatureInfo.feature=e,this.highlight(e),window.App.sidebarOpen=!0,document.getElementById("FeatureInfo").scrollIntoView()}),window.Sites.sites=[...n.features]}}},C=o(6262);const O=(0,C.A)(y,[["render",f]]);var I=O;const S={key:0,class:"ph2 pb3",id:"FeatureInfo"},x={class:"text--gray"},E={key:0,class:"info p tc mt4 grow"},L=["href"];function F(e,t,o,i,s,a){return e.feature?((0,n.uX)(),(0,n.CE)("div",S,[(0,n.Lk)("h3",null,(0,r.v_)(a.p.Name),1),(0,n.Lk)("p",x,(0,r.v_)(a.p["More Information"]),1),a.p.URL?((0,n.uX)(),(0,n.CE)("div",E,[(0,n.Lk)("a",{class:"br-pill pa2 ph3 no-underline",href:a.p.URL,target:"_blank"},"Learn more",8,L)])):(0,n.Q3)("",!0),(0,n.Lk)("div",{class:"view-on-map dn-ns tc mt4 pointer grow",onClick:t[0]||(t[0]=(...e)=>a.viewOnMap&&a.viewOnMap(...e))},[...t[1]||(t[1]=[(0,n.Lk)("span",{class:"br-pill pa2"},"View on map",-1)])])])):(0,n.Q3)("",!0)}var M={name:"FeatureInfo",data:()=>({feature:void 0}),computed:{p(){return this.feature.properties}},created(){window.FeatureInfo=this},methods:{viewOnMap(){window.App.sidebarOpen=!1}}};const A=(0,C.A)(M,[["render",F],["__scopeId","data-v-377ca9d5"]]);var N=A;const _={key:0,class:"mt2",id:"Sites"},T={key:0,class:"nearest"},U=["onClick"],X={class:"name dib w-70 pa1"},j={class:"distance dib w-30 ph1 pv1"},z={key:1,class:"all"},P=["onClick"],B={class:"name dib w-70 pa1"};function G(e,t,o,i,s,a){return e.sites?((0,n.uX)(),(0,n.CE)("div",_,[e.home?((0,n.uX)(),(0,n.CE)("div",T,[t[0]||(t[0]=(0,n.Lk)("h3",null,"Nearest groups",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.nearestSites,e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,r.C4)(["site pointer glow o-70",{selected:a.selected(e)}]),onClick:t=>a.click(e)},[(0,n.Lk)("div",X,(0,r.v_)(e.properties["Name"].replace(/ Good Karma Network/i,"")),1),(0,n.Lk)("div",j,(0,r.v_)(Math.round(e.distance))+" km",1)],10,U))),256))])):((0,n.uX)(),(0,n.CE)("div",z,[t[1]||(t[1]=(0,n.Lk)("h3",null,"All groups",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.alphabetisedSites,e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,r.C4)(["site pointer glow o-70",{selected:a.selected(e)}]),onClick:t=>a.click(e)},[(0,n.Lk)("div",B,(0,r.v_)(e.properties["Name"].replace(/ Good Karma Network/i,"")),1)],10,P))),256))]))])):(0,n.Q3)("",!0)}var Q=o(4406),R=o(2154),J=o.n(R),V={name:"Sites",data:()=>({sites:void 0,home:void 0}),created(){window.Sites=this},watch:{home(){const e=(0,Q.A)(this.home[1]);for(const t of this.sites)t.distance=e.distance(this.home,t.geometry.coordinates);this.sites.sort((e,t)=>e.distance-t.distance),window.Map.zoomToBounds(this.bbox)}},methods:{click(e){window.Map.highlight(e)},selected(e){return window.FeatureInfo.feature&&window.FeatureInfo.feature.properties.id===e.properties.id}},computed:{alphabetisedSites(){return this.sites.slice().sort((e,t)=>e.properties.Name>t.properties.Name?1:-1)},nearestSites(){return this.sites.slice(0,5)},bbox(){const e={type:"Feature",properties:{},geometry:{type:"Point",coordinates:this.home}};return J().extent({type:"FeatureCollection",features:[e,...this.nearestSites]})}}};const Y=(0,C.A)(V,[["render",G],["__scopeId","data-v-a68b4e58"]]);var K=Y;console.log(K);var W={name:"app",created(){window.App=this},data:()=>({sidebarOpen:!0}),components:{Map:I,FeatureInfo:N,Sites:K},watch:{sidebarOpen(){this.$nextTick(()=>window.map.resize())}},methods:{toggleSidebar(){this.sidebarOpen=!this.sidebarOpen}}};o(6077);const $=(0,C.A)(W,[["render",u]]);var q=$;(0,i.Ef)(q).mount("#app")}},t={};function o(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(r.exports,r,r.exports,o),r.loaded=!0,r.exports}o.m=e,function(){var e=[];o.O=function(t,i,n,r){if(!i){var s=1/0;for(l=0;l<e.length;l++){i=e[l][0],n=e[l][1],r=e[l][2];for(var a=!0,d=0;d<i.length;d++)(!1&r||s>=r)&&Object.keys(o.O).every(function(e){return o.O[e](i[d])})?i.splice(d--,1):(a=!1,r<s&&(s=r));if(a){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[i,n,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,r,s=i[0],a=i[1],d=i[2],c=0;if(s.some(function(t){return 0!==e[t]})){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(d)var l=d(o)}for(t&&t(i);c<s.length;c++)r=s[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(l)},i=self["webpackChunkmap_template"]=self["webpackChunkmap_template"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=o.O(void 0,[504],function(){return o(1546)});i=o.O(i)})();
//# sourceMappingURL=app.9db88e43.js.map